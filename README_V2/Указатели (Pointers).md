#golang #pointers #programming #memory #references

# Указатели в Go

```table-of-contents
```

[Зачем в Go амперсанд и звёздочка (& и \*)?](https://habr.com/ru/articles/339192/)
## Что такое указатели?

Указатель в Go — это переменная, которая хранит адрес памяти другой переменной. Указатели позволяют косвенно обращаться к значениям в памяти, что даёт возможность функциям изменять переменные, переданные им в качестве аргументов, и эффективно передавать большие структуры данных.

## Основные операции с указателями

В Go используются два основных оператора для работы с указателями:

- **Оператор `&`** (амперсанд) — возвращает адрес переменной. Используется для получения указателя на переменную.
- **Оператор `*`** (звёздочка) — имеет двойное значение:
  - При объявлении переменной (`*Type`) обозначает тип указателя на `Type`
  - При использовании перед переменной-указателем (`*ptr`) выполняет разыменование — обращение к значению по адресу, хранящемуся в указателе

## Пример использования указателей

```go
package main

import "fmt"

func main() {
    // Объявляем обычную переменную
    value := 42
    
    // Получаем указатель на переменную
    pointer := &value
    
    fmt.Println("Значение переменной:", value)
    fmt.Println("Адрес переменной:", pointer)
    fmt.Println("Значение через разыменование указателя:", *pointer)
    
    // Изменяем значение через указатель
    *pointer = 100
    fmt.Println("Новое значение переменной:", value)
}
```

## Указатели и функции

Одно из главных применений указателей — передача аргументов в функции по ссылке, что позволяет функции изменять исходные переменные:

```go
package main

import "fmt"

// Функция, принимающая указатель на int
func increment(n *int) {
    *n++ // Увеличиваем значение, на которое указывает n
}

func main() {
    x := 10
    fmt.Println("До вызова функции:", x)
    
    increment(&x) // Передаём адрес переменной x
    
    fmt.Println("После вызова функции:", x)
}
```

## Указатели и нулевое значение

Нулевое значение указателя — `nil`. Попытка разыменовать `nil`-указатель приведёт к панике:

```go
package main

import "fmt"

func main() {
    var ptr *int // Объявляем указатель без инициализации
    fmt.Println("Указатель:", ptr) // Выведет: <nil>
    
    // Это вызовет панику:
    // fmt.Println(*ptr)
    
    // Правильная проверка перед разыменованием:
    if ptr != nil {
        fmt.Println(*ptr)
    } else {
        fmt.Println("Указатель равен nil")
    }
}
```

## Указатели на структуры

Указатели часто используются со структурами для уменьшения копирования данных и обеспечения возможности изменения полей:

```go
package main

import "fmt"

type Person struct {
    Name string
    Age  int
}

func birthday(p *Person) {
    p.Age++ // Синтаксический сахар, эквивалентно (*p).Age++
}

func main() {
    person := Person{Name: "Алексей", Age: 30}
    
    fmt.Println("До дня рождения:", person)
    
    birthday(&person)
    
    fmt.Println("После дня рождения:", person)
}
```

## Отличие указателей Go от указателей и ссылок в C/C++

В отличие от C/C++, в Go отсутствует арифметика указателей (нельзя прибавлять или вычитать числа из указателей). Это сделано для обеспечения безопасности памяти.

Также в Go нет ссылок как в C++. В C++ ссылка — это альтернативное имя для существующей переменной, которое не имеет своего адреса. В Go же указатель — это полноценная переменная, которая имеет свой собственный адрес и хранит адрес другой переменной.

## Аналогия для понимания

Представим дом на перекрёстке улиц Ленина, 43 и Менделеева, 77. Это как значение в памяти компьютера.

- **Адрес** (улица Ленина, 43 или Менделеева, 77) — это непосредственный адрес памяти, где хранится значение. Можно сказать, что адрес — это второе имя переменной.
  
- **Указатель** — это как записка с адресом. У этой записки есть своё местоположение (свой адрес), а внутри записан адрес дома. Чтобы попасть в дом, нужно сначала прочитать записку (разыменовать указатель с помощью `*`), а затем отправиться по указанному адресу.

## Когда использовать указатели?

1. Когда нужно изменить значение переменной внутри функции
2. Когда передача больших структур данных по значению неэффективна
3. Когда работаете с методами, которые должны изменять состояние получателя
4. Когда нужно представить отсутствие значения (через `nil`)

## Заключение

Указатели — мощный инструмент в Go, который позволяет эффективно управлять памятью и передачей данных. Хотя на первый взгляд они могут показаться сложными, понимание основных принципов работы с указателями существенно расширяет возможности программирования на Go.

>[!quote] Старая версия
```
	## Указатели
	
	- `*` - разыменование указателя (пример: a := \*b), но для арументов функции - тип указателя
	- `&` - взятие адреса (пример: a := &b - положить в переменную указатель на значение)
	
	- в Gо нет ссылок, только указатели (ссылки есть в c/c++).
	- у переменой есть значение, адрес ссылки это адрес значения, а указатель на значение имеет свой собственный адрес (​это очень грубое объяснение).
	
	- представим дом, стоящий на пересечении улиц Ленина 43 и Менделеева 77, тогда мы можем заказать такси на любой из этих адресов и оно приедет в одно и то же место. это адрес. можно сказать что адрес это второе имя переменной, а указатель это коробка при открытии которой нам скажут по какому адресу лежит значение. указатель нужно разыменовывать. адрес нет.
	
	[Зачем в Go амперсанд и звёздочка (& и \*)?](https://habr.com/ru/articles/339192/)
	
```
